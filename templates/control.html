{% extends 'base.html' %}

{% block title %}
Управление роботом
{% endblock %}

{% block body %}
<div class="container px-4 py-5">
  <div class="card text-center">
    <div class=" card-body py-5 text-center container">
      <h1 class="fs-2 text">Управление</h1>
      <div class="row">
        <div class="col-sm">
          <p>
            <!-- Вперед -->
            <button id="up" type="button" class="btn btn-secondary my-2" id="up">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-arrow-up-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm8.5 9.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V11.5z">
                </path>
              </svg>
            </button>
            
            <button type="button" class="btn btn-secondary" data-bs-toggle="tooltip" data-bs-placement="right" title="Подсказка справа">
              Подсказка справа
            </button>
          </p>
          <p>
            <!-- Влево -->
            <button type="button" class="btn btn-secondary my-2" style="margin-right:50px;" id="left">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-arrow-left-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z">
                </path>
              </svg>
            </button>
            <!-- Вправо -->
            <button type="button" class="btn btn-secondary my-2" style="margin-left:50px;" id="right">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-arrow-right-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z">
                </path>
              </svg>
            </button>
          </p>
          <p>
            <!-- Назад -->
            <button type="button" class="btn btn-secondary my-2" id="down">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-arrow-down-square" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm8.5 2.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V4.5z">
                </path>
              </svg>
            </button>
          </p>
        </div>

        <script>
          $(document).ready(function () {
            $("#down").on("mousedown", function () {
              $.get('/down_side');
            }).on('mouseup', function () {
              $.get('/stop');
            });
            $("#up").on("mousedown", function () {
              $.get('/up_side');
            }).on('mouseup', function () {
              $.get('/stop');
            });
            $("#left").on("mousedown", function () {
              $.get('/left_side');
            }).on('mouseup', function () {
              $.get('/stop');
            });
            $("#right").on("mousedown", function () {
              $.get('/right_side');
            }).on('mouseup', function () {
              $.get('/stop');
            });
          });
        </script>

        <div class="col-sm">
          <video id="camera-feed" width="640" height="480"></video>
          <br>
       <button id="capture-btn">Сделать снимок</button>
       <br>
       <canvas id="photo-canvas"></canvas>
       <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
       <script>
         $(document).ready(function() {
           var video = document.getElementById('camera-feed');
           var canvas = document.getElementById('photo-canvas');
           var btnCapture = document.getElementById('capture-btn');

           navigator.mediaDevices.getUserMedia({video: true, audio: false})
             .then(function(stream) {
               video.srcObject = stream;
               video.play();
             })
             .catch(function(err) {
               console.log(err);
             });

           btnCapture.addEventListener('click', function() {
             canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
             var imgBase64 = canvas.toDataURL('image/jpeg');
             $.ajax({
               type: 'POST',
               url: '/save-photo',
               data: {photo_data: imgBase64},
               success: function(response) {
                 console.log(response);
               }
             });
           });
         });
       </script>
        </div>
      </div>
    </div>
  </div>
  <div class="b-example-divider"></div>
  <div class="container px-4 py-5">
    <div class="card text-center">
      <div class=" card-body py-5 text-center container">
        <h1 class="fs-2 text">Подсветка</h1>
        <form method="POST" action="/on" class="py-2">
          <button type="button" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb"
              viewBox="0 0 16 16">
              <path
                d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z">
              </path>
            </svg>
            Спереди
          </button>
        </form>
        <form method="POST" action="/on" class="py-2">
          <button type="button" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb"
              viewBox="0 0 16 16">
              <path
                d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z">
              </path>
            </svg>
            Сзади
          </button>
        </form>
        <form method="POST" action="/on" class="py-2">
          <button type="button" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lightbulb"
              viewBox="0 0 16 16">
              <path
                d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z">
              </path>
            </svg>
            Вся
          </button>
        </form>
      </div>
    </div>
  </div>
  {% endblock %}